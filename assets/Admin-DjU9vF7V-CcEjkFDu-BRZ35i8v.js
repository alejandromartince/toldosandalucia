import{W as c,$ as e}from"./index-dsjFZDld.js";const p=({onUploadSuccess:t})=>{const[i,n]=c.useState(null),[r,s]=c.useState(""),[d,h]=c.useState(""),x=async o=>{if(o.preventDefault(),!i||!r){h("❌ Debes seleccionar una imagen y una categoría");return}const l=new FormData;l.append("imagen",i),l.append("categoria",r);try{const a=await fetch("http://localhost:3000/imagenes",{method:"POST",body:l});if(a.ok)h("✅ Imagen subida correctamente"),n(null),s(""),t&&t();else{const u=await a.json();h(`❌ Error: ${u.error}`)}}catch(a){console.error(a),h("❌ Error al subir la imagen")}};return e.jsxs("div",{children:[e.jsx("h3",{children:"Subir imagen"}),e.jsxs("form",{onSubmit:x,children:[e.jsx("input",{type:"file",onChange:o=>n(o.target.files[0])}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("select",{value:r,onChange:o=>s(o.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar categoría"}),e.jsx("option",{value:"pergola",children:"Pérgola"}),e.jsx("option",{value:"terraza",children:"Terraza"}),e.jsx("option",{value:"veranda",children:"Veranda"})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{type:"submit",children:"Subir"})]}),d&&e.jsx("p",{children:d})]})},m=({imagenes:t,onDeleteSuccess:i})=>{const n=async r=>{if(window.confirm("¿Seguro que deseas eliminar esta imagen?"))try{const s=await fetch(`http://localhost:3000/imagenes/${r}`,{method:"DELETE"});if(s.ok)i&&i();else{const d=await s.json();alert(`Error al eliminar: ${d.error}`)}}catch(s){console.error("Error al eliminar imagen:",s)}};return e.jsxs("div",{children:[e.jsx("h3",{children:"Lista de Imágenes"}),t.length===0?e.jsx("p",{children:"No hay imágenes subidas."}):e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"1rem"},children:t.map(r=>e.jsxs("div",{style:{border:"1px solid #ccc",padding:"1rem"},children:[e.jsx("img",{src:`http://localhost:3000${r.ruta}`,alt:r.nombre,style:{maxWidth:"200px",height:"auto"}}),e.jsxs("p",{children:[e.jsx("strong",{children:"Categoría:"})," ",r.categoria]}),e.jsx("button",{onClick:()=>n(r.id),children:"Eliminar"})]},r.id))})]})},b=()=>{const[t,i]=c.useState(!1),[n,r]=c.useState(""),[s,d]=c.useState(""),[h,x]=c.useState([]),o=async a=>{a.preventDefault();try{const u=await fetch("undefined/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario:n,password:s})});if(u.ok)i(!0),l();else{const j=await u.json();alert(j.mensaje||"Error al iniciar sesión")}}catch(u){alert("Error de conexión al servidor"),console.error(u)}},l=async()=>{try{const a=await(await fetch("undefined/imagenes")).json();x(a)}catch(a){console.error("Error al cargar imágenes:",a)}};return t?e.jsxs("div",{className:"dashboardSection",children:[e.jsxs("h2",{children:["Bienvenido, ",n]}),e.jsx(p,{onUploadSuccess:l}),e.jsx("hr",{}),e.jsx(m,{imagenes:h,onDeleteSuccess:l})]}):e.jsxs("div",{className:"loginSection",children:[e.jsx("h2",{children:"Iniciar sesión"}),e.jsxs("form",{onSubmit:o,children:[e.jsx("input",{type:"text",placeholder:"Usuario",value:n,onChange:a=>r(a.target.value)}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("input",{type:"password",placeholder:"Contraseña",value:s,onChange:a=>d(a.target.value)}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{type:"submit",children:"Entrar"})]})]})};export{b as default};
