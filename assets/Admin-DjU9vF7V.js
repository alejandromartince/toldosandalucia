import{fV as h,fW as e}from"./index-CZwUsJu8.js";const g=({onUploadSuccess:i})=>{const[c,t]=h.useState(null),[r,u]=h.useState(""),[s,n]=h.useState(""),m=async l=>{if(l.preventDefault(),!c||!r){n("❌ Debes seleccionar una imagen y una categoría");return}const d=new FormData;d.append("imagen",c),d.append("categoria",r);try{const a=await fetch("http://localhost:3000/imagenes",{method:"POST",body:d});if(a.ok)n("✅ Imagen subida correctamente"),t(null),u(""),i&&i();else{const o=await a.json();n(`❌ Error: ${o.error}`)}}catch(a){console.error(a),n("❌ Error al subir la imagen")}};return e.jsxs("div",{children:[e.jsx("h3",{children:"Subir imagen"}),e.jsxs("form",{onSubmit:m,children:[e.jsx("input",{type:"file",onChange:l=>t(l.target.files[0])}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("select",{value:r,onChange:l=>u(l.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar categoría"}),e.jsx("option",{value:"pergola",children:"Pérgola"}),e.jsx("option",{value:"terraza",children:"Terraza"}),e.jsx("option",{value:"veranda",children:"Veranda"})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{type:"submit",children:"Subir"})]}),s&&e.jsx("p",{children:s})]})},j=({imagenes:i,onDeleteSuccess:c})=>{const t=async r=>{if(window.confirm("¿Seguro que deseas eliminar esta imagen?"))try{const s=await fetch(`http://localhost:3000/imagenes/${r}`,{method:"DELETE"});if(s.ok)c&&c();else{const n=await s.json();alert(`Error al eliminar: ${n.error}`)}}catch(s){console.error("Error al eliminar imagen:",s)}};return e.jsxs("div",{children:[e.jsx("h3",{children:"Lista de Imágenes"}),i.length===0?e.jsx("p",{children:"No hay imágenes subidas."}):e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"1rem"},children:i.map(r=>e.jsxs("div",{style:{border:"1px solid #ccc",padding:"1rem"},children:[e.jsx("img",{src:`http://localhost:3000${r.ruta}`,alt:r.nombre,style:{maxWidth:"200px",height:"auto"}}),e.jsxs("p",{children:[e.jsx("strong",{children:"Categoría:"})," ",r.categoria]}),e.jsx("button",{onClick:()=>t(r.id),children:"Eliminar"})]},r.id))})]})},f=()=>{const[i,c]=h.useState(!1),[t,r]=h.useState(""),[u,s]=h.useState(""),[n,m]=h.useState([]),l=async a=>{a.preventDefault();try{const o=await fetch("undefined/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario:t,password:u})});if(o.ok)c(!0),d();else{const x=await o.json();alert(x.mensaje||"Error al iniciar sesión")}}catch(o){alert("Error de conexión al servidor"),console.error(o)}},d=async()=>{try{const o=await(await fetch("undefined/imagenes")).json();m(o)}catch(a){console.error("Error al cargar imágenes:",a)}};return i?e.jsxs("div",{className:"dashboardSection",children:[e.jsxs("h2",{children:["Bienvenido, ",t]}),e.jsx(g,{onUploadSuccess:d}),e.jsx("hr",{}),e.jsx(j,{imagenes:n,onDeleteSuccess:d})]}):e.jsxs("div",{className:"loginSection",children:[e.jsx("h2",{children:"Iniciar sesión"}),e.jsxs("form",{onSubmit:l,children:[e.jsx("input",{type:"text",placeholder:"Usuario",value:t,onChange:a=>r(a.target.value)}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("input",{type:"password",placeholder:"Contraseña",value:u,onChange:a=>s(a.target.value)}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("button",{type:"submit",children:"Entrar"})]})]})};export{f as default};
